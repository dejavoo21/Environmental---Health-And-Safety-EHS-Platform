TC-ID,Category,Title,Description,Preconditions,Steps,Expected Result,US-ID,C-ID,Priority
TC-NOTIF-01,Notification Creation,Action assigned creates notification,Verify notification created when action assigned to user,User exists; action module enabled,1. Create action with assigned_to user 2. Query notifications for assignee,In-app notification created with type action_assigned,US-NOTIF-01,C-096,High
TC-NOTIF-02,Notification Creation,Action assigned sends email if preference enabled,Verify email sent when user has email_action_assigned=true,User has email preference enabled,1. Create action with assigned_to user 2. Check email logs,Email sent to assignee with action details,US-NOTIF-01,C-096,High
TC-NOTIF-03,Notification Creation,Action assigned no email if preference disabled,Verify no email sent when user has email_action_assigned=false,User has email preference disabled,1. Create action with assigned_to user 2. Check email logs,No email sent; only in-app notification,US-NOTIF-01,C-096,High
TC-NOTIF-04,Notification Creation,Action status change notifies creator,Verify creator notified when action completed,Action exists with different creator and assignee,1. Update action status to completed 2. Query notifications for creator,Notification created for action creator,US-NOTIF-02,C-097,Medium
TC-NOTIF-05,Notification Creation,High-severity incident notifies managers,Verify all managers notified on critical incident,At least one manager in org,1. Create incident with severity=critical 2. Query notifications for managers,All managers have HIGH priority notification,US-NOTIF-05,C-098,High
TC-NOTIF-06,Notification Creation,High-severity notification has HIGH priority,Verify notification priority is high for critical incidents,Manager exists,1. Create critical incident 2. Check notification priority field,priority field is 'high',US-NOTIF-05,C-098,Medium
TC-NOTIF-07,Notification Creation,Notification has correct metadata,Verify notification metadata contains action details,Action exists,1. Create action notification 2. Check metadata field,Metadata contains actionTitle dueDate sourceType sourceId,US-NOTIF-01,C-096,Medium
TC-NOTIF-08,Notification Creation,Notification expires after retention period,Verify expires_at set correctly,Org has retention setting,1. Create notification 2. Check expires_at field,expires_at = created_at + retention_days,US-SYS-01,C-110,Low
TC-NOTIF-09,Notification Creation,Notification scoped to user org,Verify notification has correct organisation_id,Multiple orgs exist,1. Create notification 2. Check organisation_id,organisation_id matches user's org,US-SYS-01,C-110,High
TC-NOTIF-10,Notification Creation,Duplicate notifications prevented,Verify same event doesn't create duplicate notifications,Notification already exists for event,1. Trigger same event again 2. Count notifications,No duplicate notification created,US-SYS-01,C-110,Medium
TC-NOTIF-11,Notification Retrieval,GET /notifications returns user's notifications,Verify endpoint returns notifications for authenticated user,User has notifications,1. GET /api/notifications 2. Check response,Returns array of user's notifications,US-NOTIF-03,C-104,High
TC-NOTIF-12,Notification Retrieval,Notifications paginated correctly,Verify pagination works with page and limit params,User has 30+ notifications,1. GET /api/notifications?page=2&limit=10 2. Check response,Returns items 11-20 with correct pagination metadata,US-NOTIF-04,C-105,Medium
TC-NOTIF-13,Notification Retrieval,Filter by type works,Verify type filter returns only matching notifications,User has multiple notification types,1. GET /api/notifications?type=action_assigned 2. Check response,Only action_assigned notifications returned,US-NOTIF-04,C-105,Medium
TC-NOTIF-14,Notification Retrieval,Filter by is_read works,Verify read status filter works,User has read and unread notifications,1. GET /api/notifications?is_read=false 2. Check response,Only unread notifications returned,US-NOTIF-04,C-105,Medium
TC-NOTIF-15,Notification Retrieval,Unread count endpoint works,Verify GET /notifications/unread-count returns correct count,User has 5 unread notifications,1. GET /api/notifications/unread-count 2. Check response,Returns count: 5,US-NOTIF-03,C-103,High
TC-NOTIF-16,Notification Retrieval,Unread count capped at 99,Verify count does not exceed 99 for badge display,User has 150 unread notifications,1. GET /api/notifications/unread-count 2. Check response,Returns count: 99,US-NOTIF-03,C-103,Low
TC-NOTIF-17,Notification Retrieval,Notifications sorted by created_at desc,Verify newest notifications first,User has multiple notifications,1. GET /api/notifications 2. Check order,Notifications ordered by created_at descending,US-NOTIF-04,C-105,Medium
TC-NOTIF-18,Notification Retrieval,Other user's notifications not visible,Verify user cannot see other user's notifications,Two users in same org,1. User A queries notifications 2. Check for User B's notifications,Only User A's notifications returned,US-SYS-01,C-110,High
TC-NOTIF-19,Notification Retrieval,Other org notifications not visible,Verify org isolation for notifications,Two orgs exist,1. User in Org A queries notifications 2. Check for Org B notifications,No Org B notifications returned,US-SYS-01,C-110,High
TC-NOTIF-20,Notification Retrieval,Date range filter works,Verify startDate and endDate filters work,User has notifications over multiple days,1. GET /api/notifications?startDate=X&endDate=Y 2. Check response,Only notifications in date range returned,US-NOTIF-04,C-105,Low
TC-NOTIF-21,Notification Actions,Mark single notification as read,Verify PUT /:id/read marks notification as read,Unread notification exists,1. PUT /api/notifications/:id/read 2. Check notification,is_read=true read_at set,US-NOTIF-03,C-104,High
TC-NOTIF-22,Notification Actions,Mark all as read works,Verify PUT /mark-all-read marks all unread as read,Multiple unread notifications,1. PUT /api/notifications/mark-all-read 2. Query notifications,All notifications have is_read=true,US-NOTIF-03,C-104,High
TC-NOTIF-23,Notification Actions,Mark all as read returns count,Verify response includes number of notifications updated,5 unread notifications,1. PUT /api/notifications/mark-all-read 2. Check response,Response contains updated: 5,US-NOTIF-03,C-104,Low
TC-NOTIF-24,Notification Actions,Delete notification works,Verify DELETE /:id removes notification,Notification exists,1. DELETE /api/notifications/:id 2. Query notification,Notification no longer exists,US-NOTIF-04,C-105,Medium
TC-NOTIF-25,Notification Actions,Cannot mark other user's notification,Verify 404 when marking another user's notification,Notification belongs to different user,1. PUT /api/notifications/:otherId/read 2. Check response,Returns 404 Not Found,US-SYS-01,C-110,High
TC-NOTIF-26,Notification Actions,Read notification clicking updates read status,Verify clicking notification in UI marks as read,Unread notification in dropdown,1. Click notification 2. Check is_read status,Notification marked as read,US-NOTIF-03,C-104,High
TC-NOTIF-27,Notification Actions,Clicking notification navigates to item,Verify navigation to related entity on click,Notification has relatedType and relatedId,1. Click notification 2. Check URL,Navigated to /actions/:relatedId,US-NOTIF-03,C-104,High
TC-NOTIF-28,Notification Actions,Badge updates after mark all read,Verify bell badge shows 0 after marking all read,Unread notifications exist,1. Click mark all read 2. Check badge,Badge shows 0 or hidden,US-NOTIF-03,C-103,Medium
TC-NOTIF-29,Notification Actions,Badge updates on new notification,Verify badge increments when new notification arrives,Badge showing 5,1. Create action assigned to user 2. Wait for poll 3. Check badge,Badge shows 6,US-NOTIF-03,C-103,Medium
TC-NOTIF-30,Notification Actions,Empty state shown when no notifications,Verify empty state message when user has no notifications,User has no notifications,1. Open notification dropdown 2. Check content,Shows 'No notifications yet',US-NOTIF-03,C-104,Low
TC-PREF-01,Preferences,GET preferences returns current settings,Verify preferences endpoint returns user's settings,User has preferences saved,1. GET /api/preferences/notifications 2. Check response,Returns all preference fields,US-PREF-01,C-108,High
TC-PREF-02,Preferences,Default preferences created for new user,Verify defaults created when no preferences exist,User exists but no preferences record,1. GET /api/preferences/notifications 2. Check response,Default preferences returned and record created,US-PREF-01,C-108,High
TC-PREF-03,Preferences,Manager gets weekly digest default,Verify manager role gets digestFrequency=weekly by default,New manager user,1. Create manager user 2. GET preferences,digestFrequency is 'weekly',US-PREF-02,C-102,Medium
TC-PREF-04,Preferences,Worker gets none digest default,Verify worker role gets digestFrequency=none by default,New worker user,1. Create worker user 2. GET preferences,digestFrequency is 'none',US-PREF-02,C-102,Medium
TC-PREF-05,Preferences,PUT preferences updates settings,Verify preferences can be updated,User has preferences,1. PUT /api/preferences/notifications with new values 2. GET preferences,Values updated correctly,US-PREF-01,C-108,High
TC-PREF-06,Preferences,Invalid digestFrequency rejected,Verify validation for digestFrequency enum,User exists,1. PUT preferences with digestFrequency='invalid' 2. Check response,Returns 400 validation error,US-PREF-01,C-108,Medium
TC-PREF-07,Preferences,Invalid digestTime rejected,Verify validation for digestTime format,User exists,1. PUT preferences with digestTime='25:00' 2. Check response,Returns 400 validation error,US-PREF-01,C-108,Medium
TC-PREF-08,Preferences,Partial update works,Verify can update single field,User has preferences,1. PUT preferences with only emailActionAssigned 2. Check other fields,Only specified field changed,US-PREF-01,C-108,Medium
TC-PREF-09,Preferences,Preferences scoped to user,Verify user can only see own preferences,Two users exist,1. User A gets preferences 2. Check for User B data,Only User A's preferences,US-PREF-01,C-108,High
TC-PREF-10,Preferences,Preferences UI loads correctly,Verify preferences page displays all options,User logged in,1. Navigate to /settings/notifications 2. Check form,All preference fields visible,US-PREF-01,C-109,High
TC-PREF-11,Preferences,Save button shows success toast,Verify toast notification on save,User on preferences page,1. Change preference 2. Click Save 3. Check toast,Success toast displayed,US-PREF-01,C-109,Low
TC-PREF-12,Preferences,Cancel reverts unsaved changes,Verify cancel button reverts changes,User changed but not saved,1. Change preference 2. Click Cancel 3. Check form,Original values restored,US-PREF-01,C-109,Low
TC-PREF-13,Preferences,Digest day only shown for weekly,Verify day of week field only visible when weekly selected,User on preferences page,1. Select weekly digest 2. Check for day field,Day of week field visible,US-PREF-02,C-102,Low
TC-PREF-14,Preferences,Preferences persist across sessions,Verify preferences saved to database persist,User saved preferences,1. Save preferences 2. Logout 3. Login 4. Check preferences,Same preferences loaded,US-PREF-01,C-108,Medium
TC-PREF-15,Preferences,Email preference affects notification emails,Verify changing email preference affects email delivery,User with action assigned to them,1. Disable emailActionAssigned 2. Create action 3. Check email logs,No email sent,US-PREF-01,C-108,High
TC-DIGEST-01,Digest Jobs,Daily digest job runs at scheduled time,Verify daily digest job executes at 07:00,Job scheduler configured,1. Wait for 07:00 2. Check job runs table,Job run record created with status completed,US-DIGEST-01,C-100,High
TC-DIGEST-02,Digest Jobs,Daily digest queries correct users,Verify only users with digestFrequency=daily receive digest,Mix of daily/weekly/none users,1. Run daily digest job 2. Check email logs,Only daily users received email,US-DIGEST-01,C-100,High
TC-DIGEST-03,Digest Jobs,Daily digest contains new incidents,Verify digest includes incidents from last 24 hours,Incidents created yesterday,1. Run daily digest 2. Check email content,Email contains incident summaries,US-DIGEST-01,C-100,High
TC-DIGEST-04,Digest Jobs,Daily digest contains actions due soon,Verify digest includes actions due in next 7 days,Actions with due dates in next week,1. Run daily digest 2. Check email content,Email contains action summaries,US-DIGEST-01,C-100,High
TC-DIGEST-05,Digest Jobs,Daily digest contains overdue actions,Verify digest includes overdue actions,Overdue actions exist,1. Run daily digest 2. Check email content,Email contains overdue action list,US-DIGEST-01,C-100,High
TC-DIGEST-06,Digest Jobs,Empty digest not sent,Verify no email sent when no content,No incidents or actions to report,1. Run daily digest 2. Check email logs,No email sent for empty digest,US-DIGEST-01,C-100,Medium
TC-DIGEST-07,Digest Jobs,Weekly digest runs on Monday,Verify weekly digest job executes on Monday 07:00,Job scheduler configured,1. Wait for Monday 07:00 2. Check job runs table,Job run record created,US-DIGEST-02,C-101,High
TC-DIGEST-08,Digest Jobs,Weekly digest covers 7 days,Verify weekly digest includes full week of data,Data from past 7 days,1. Run weekly digest 2. Check email content,Email contains week's incidents and actions,US-DIGEST-02,C-101,High
TC-DIGEST-09,Digest Jobs,Job run logged correctly,Verify job execution creates proper log,Job completes,1. Run digest job 2. Check scheduled_job_runs,Record has correct counts and status,US-SYS-01,C-111,Medium
TC-DIGEST-10,Digest Jobs,Job handles email failure gracefully,Verify job continues if single email fails,Email to one user fails,1. Run digest with email failure 2. Check job run,items_failed incremented; job completes,US-SYS-01,C-111,Medium
TC-DIGEST-11,Digest Jobs,Admin can trigger digest manually,Verify POST /admin/jobs/digest/trigger works,Admin user,1. POST trigger endpoint 2. Check job runs,Job executed,US-SYS-01,C-111,Medium
TC-DIGEST-12,Digest Jobs,Manual trigger can target specific user,Verify userId parameter works,Admin user,1. POST trigger with userId 2. Check email logs,Only specified user received email,US-SYS-01,C-111,Low
TC-ESC-01,Escalation,Escalation job runs daily,Verify escalation job executes at 08:00,Job scheduler configured,1. Wait for 08:00 2. Check job runs table,Job run record created,US-ESC-01,C-106,High
TC-ESC-02,Escalation,Overdue actions detected correctly,Verify job finds actions overdue by X days,Actions overdue by org threshold,1. Run escalation job 2. Check actions processed,Correct actions identified for escalation,US-ESC-01,C-106,High
TC-ESC-03,Escalation,Escalation notification created for assignee,Verify in-app notification for action assignee,Overdue action exists,1. Run escalation job 2. Check notifications,Assignee has escalation notification,US-ESC-01,C-106,High
TC-ESC-04,Escalation,Escalation notification created for managers,Verify in-app notification for org managers,Overdue action exists,1. Run escalation job 2. Check manager notifications,All managers have escalation notification,US-ESC-01,C-106,High
TC-ESC-05,Escalation,Escalation email sent,Verify email sent to assignee and managers,Overdue action exists,1. Run escalation job 2. Check email logs,Escalation emails sent,US-ESC-01,C-106,High
TC-ESC-06,Escalation,Custom escalation email works,Verify custom email receives escalation,Org has customEmail configured,1. Run escalation job 2. Check email logs,Custom email address received escalation,US-ESC-02,C-107,Medium
TC-ESC-07,Escalation,Action marked as escalated,Verify action not re-escalated,Action already escalated,1. Run escalation job twice 2. Check email count,Only one escalation email sent,US-ESC-01,C-106,High
TC-ESC-08,Escalation,Escalation respects org threshold,Verify different orgs use different thresholds,Org A: 3 days; Org B: 5 days,1. Action overdue 4 days 2. Run escalation,Org A escalates; Org B does not,US-ESC-02,C-107,Medium
TC-ESC-09,Escalation,Escalation can be disabled,Verify no escalation when org disables,Org has escalation.enabled=false,1. Run escalation job 2. Check for escalations,No escalations created,US-ESC-02,C-107,Medium
TC-ESC-10,Escalation,Escalation audit logged,Verify escalation event in audit log,Escalation triggered,1. Run escalation job 2. Check audit_logs,Escalation event recorded,US-SYS-01,C-112,Medium
TC-ESC-11,Escalation Admin,Admin can update escalation settings,Verify PUT escalation settings works,Admin user,1. PUT /admin/organisation/escalation 2. Check settings,Settings updated,US-ESC-02,C-107,High
TC-ESC-12,Escalation Admin,Invalid threshold rejected,Verify validation for daysOverdue,Admin user,1. PUT with daysOverdue=50 2. Check response,Returns 400 validation error,US-ESC-02,C-107,Medium
TC-ESC-13,Escalation Admin,Non-admin cannot update settings,Verify manager/worker cannot update,Manager user,1. PUT escalation settings 2. Check response,Returns 403 Forbidden,US-ESC-02,C-107,High
TC-ESC-14,Escalation Admin,Settings UI displays correctly,Verify escalation settings section visible to admin,Admin user,1. Navigate to org settings 2. Check for escalation section,Escalation settings visible,US-ESC-02,C-107,Medium
TC-ESC-15,Escalation Admin,Settings changes take effect immediately,Verify new threshold used on next job run,Admin updates threshold,1. Update threshold to 5 days 2. Run job 3. Check behavior,New threshold applied,US-ESC-02,C-107,Medium
